(function(){var n="mokuso",u=function(n){return n&&$.isArray(n)?!0:n&&kendo.isFunction(n.shift)&&kendo.isFunction(n.slice)?!0:!1},i=function(n){return n&&$.type(n.uid)=="string"&&kendo.isFunction(n.get)&&kendo.isFunction(n.set)?!0:!1},s=function(n){var r,t,i;if(n=="")return{};for(a=n.split("&"),r={},t=0;t<a.length;++t)(i=a[t].split("="),i.length==2)&&(r[i[0]]=decodeURIComponent(i[1].replace(/\+/g," ")));return r},f=function(n){return $.extend({node:$("body"),initial:null,init:null,transition:null,root:"/",pushState:!1,hashBang:!1,kendoMobileApplication:null},n)},h=function(t,i,r){t.model.preinit(i,r);var u=i.parents("*[data-role='"+n+"view']:first").data(n+"View");u&&u instanceof kendo.Layout?u.showIn(t,i):t.render(i)},e=function(n){return $.ajax({url:require.toUrl("view/"+n+".html")}).promise()},r=function(u,f,o){var v,a,y,b;if($.type(f)=="string"&&!($.trim(f).length<=0)&&$.type(u)=="object"){var l=$.Deferred(),p=f.indexOf("?"),c=p>0?f.substring(0,p):f,w=i(o)?o:new kendo.data.ObservableObject($.isPlainObject(o)?o:{}),s=u;return u instanceof $||(s=$(u)),v=s.find("*[data-role='"+n+"view']"),s.data(n+"View")&&v.push(s),a=null,v.length?(y=$.Deferred(),a=$.Deferred(),b=$.map(v,function(n){var t=$(n);return{depth:t.parents().length,node:t}}).sort(function(n,t){return t.depth-n.depth}).reduce(function(t,i){return t.then(function(){return i.node.data(n+"View").model.deinit(i.node)})},y),b.always(function(){s.data(n+"View").destroy();s.empty()}).always(function(){return t.trigger("before-route",[c,s]),e(c).always(function(n){a.resolveWith(null,[n])})}),y.resolve()):(t.trigger("before-route",[c,s]),a=e(c)),require(["viewmodel/"+c],function(t){a.then(function(i){var u=new kendo.View("<div>"+i+"<\/div>",{model:kendo.observable($.extend(!0,{preinit:function(){},init:function(){},reinit:function(){},deinit:function(){}},t)),init:function(){var t=this,i=this.element.parent();i.attr("data-role",n+"view");i.attr("data-view",c);$.when(this.model.init(this.element,w)).always(function(){var _model=t.model,u=t.element,i=[];u.find("*[data-role='"+n+"view']").each(function(n,t){var _n=$(t),_args=new kendo.data.ObservableObject({}),arrBindFields,__args,fProp,_type,tProp;if($.trim(_n.attr("data-view-args")).length)with(_model){arrBindFields=[];__args={};try{eval("__args = "+_n.attr("data-view-args"))}catch(u){console.error("Argument Parsing Error","Could not parse inline page arguments: "+_n.attr("data-view-args"))}for(fProp in __args)if(_type=$.type(__args[fProp]),_type=="string"||_type=="number"||_type=="object")_args.set(fProp,__args[fProp]);else for(tProp in _model)if(__args[fProp]===_model[tProp]){arrBindFields.push({f:fProp,t:tProp});_args.set(fProp,_model.get(tProp));break}arrBindFields.length&&_model.bind("change",function(n){for(var x=0;x<arrBindFields.length;x++)if(arrBindFields[x].t==n.field){_args.set(arrBindFields[x].t,this.get(n.field));break}})}i.push(r(_n,_n.attr("data-view"),_args))});$.when.apply($,i).then(function(){l.resolve()}).fail(function(){l.rejectWith(null,arguments)})})},wrap:!1});s.data(n+"View",u);h(u,s,w)}).fail(function(){l.rejectWith(null,arguments)})},function(){l.rejectWith(null,arguments)}),l.fail(function(){console.error("Page load failed: ",arguments)}).always(function(){t.trigger("after-route",[c,s])}),l}},t=$({}),o;return kendo.isArray=u,kendo.isObservableObject=i,kendo.mobile&&(kendo.mobile.isArray=u,kendo.mobile.isObservableObject=i),o=kendo.Class.extend({options:{},events:["init","before-route","after-route"],router:null,init:function(){},initialize:function(n,t){var u=this,i;this.options=f(t);n&&(this.options.node=n);kendo.mobile&&kendo.mobile.Application&&this.options.kendoMobileApplication&&this.options.kendoMobileApplication instanceof kendo.mobile.Application?this.router=this.options.kendoMobileApplication.router:(this.options.kendoMobileApplication=null,this.router=new kendo.Router({pushState:this.options.pushState,hashBang:this.options.hasBang,root:this.options.root}),this.router.route("*page",function(n,t){r(u.options.node,n,t).fail(function(){u.router.trigger("routeMissing")})}),i=location.href.indexOf("#"),$.trim(this.options.initial).length&&(i<0||i==location.href.length-1)&&(location.href=i<0?location.href+"#"+this.options.initial:location.href.substring(0,i)+"#"+this.options.initial),this.router.start(),$.isFunction(this.options.init)&&this.options.init(),this.trigger("init"))},initializeMobile:function(t,i){var u=this,r;if(this.options=f(i),t&&(this.options.node=t),r=function(r){return u.initialize(t,$.extend($.extend({},i,{initial:null,kendoMobileApplication:new kendo.mobile.Application(r,$.extend($.extend({},i),{init:function(){var t,r,u;this.router.bind("change",function(t){var i=t.url.indexOf("?"),r=$("*[data-role='view'][id='"+(i>0?t.url.substring(0,i):t.url)+"']"),u=r.data(n+"View");u&&u.model.reinit(r,t.params)});t=$.trim(location.hash.replace("#",""));t.length?(r=t.indexOf("?"),this.router.trigger("change",{url:t,params:r>0?s(t.substring(r+1)):{}})):(u=$("*[data-role='view']:visible"),u.length&&this.router.trigger("change",{url:u.attr("id"),params:{}}));$.isFunction(i.init)&&i.init()},initial:i._initial||null}))})))},kendo.mobile&&kendo.mobile.Application)return $.type(i.initial)=="string"&&$.trim(i.initial).length>0?this.load(t,i.initial).then(function(){var t=$("*[data-role='"+n+"view']:first").data(n+"View").element;t.find("*[data-role='"+n+"view']").each(function(){var i=$(this).data(n+"View");$(this).data(n+"View").element.children("[data-role]").each(function(){$(this).data(n+"View",i);t.append(this)})})}).then(function(){return r($("*[data-role='"+n+"view']:first").data(n+"View").element)}):r(t);console.error("App not initialized: kendo mobile libs required (kendo.mobile.Application)")},navigate:function(n){if(!this.router){console.error("App not initialized: call initialize(DomNode contentNode, JSON options)");return}if($.type(n)=="string"&&$.trim(n).length>0)return this.options.kendoMobileApplication?this.options.kendoMobileApplication.navigate.apply(this.options.kendoMobileApplication,arguments):this.router.navigate.apply(this.router,arguments);console.error("Arguments Exception","Page is empty; Usage: navigate(String page)")},replace:function(n){if(!this.router){console.error("App not initialized: call initialize(DomNode contentNode, JSON options)");return}if($.type(n)=="string"&&$.trim(n).length>0)return this.options.kendoMobileApplication?this.options.kendoMobileApplication.replace.apply(this.options.kendoMobileApplication,arguments):this.router.replace.apply(this.router,arguments);console.error("Arguments Exception","Page is empty; Usage: replace(String page)")},load:function(n,t,i){if($.type(t)=="string"&&$.trim(t).length>0&&$.type(n)=="object")return r(n,t,i);console.error("Arguments Exception","Page is empty or node is not a DOM element; Usage: load(String page, DomNode node)")},showLoading:function(){this.options.kendoMobileApplication?this.options.kendoMobileApplication.showLoading():kendo.ui.progress(this.options.node,!0)},hideLoading:function(){kendo.ui.progress(this.options.node,!1);this.options.kendoMobileApplication&&this.options.kendoMobileApplication.hideLoading()},bind:function(n,i){$.type(n)=="string"&&$.trim(n).length>0&&$.isFunction(i)?this.options.kendoMobileApplication?this.options.kendoMobileApplication.bind.apply(this.options.kendoMobileApplication,arguments):t.bind.apply(t,arguments):console.error("Arguments Exception","Event is empty or method is not a function; Usage: bind(String event, Function method, ...)")},trigger:function(n){$.type(n)=="string"&&$.trim(n).length>0?this.options.kendoMobileApplication?this.options.kendoMobileApplication.trigger.apply(this.options.kendoMobileApplication,arguments):t.trigger.apply(t,arguments):console.error("Arguments Exception","Event is empty ; Usage: bind(String event, ...)")}}),window[n]=new o,window[n]})();
