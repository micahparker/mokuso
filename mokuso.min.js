(function () { var t = "mokuso", n = new (kendo.Class.extend({ isArray: function (n) { return n && $.isArray(n) ? !0 : n && kendo.isFunction(n.shift) && kendo.isFunction(n.slice) ? !0 : !1 }, isObservableObject: function (n) { return n && $.type(n.uid) == "string" && kendo.isFunction(n.get) && kendo.isFunction(n.set) ? !0 : !1 }, handleModuleHook: function (n, t, i) { for (var u = [], r = 0; r < n.length; r++) $.isFunction(n[r][t]) && u.push(n[r][t].apply(n[r][t], i || [])); return $.when.apply(null, u) }, findNestedViews: function (n, i, r) { var u = []; return n.find("*[data-role='" + t + "view']").addBack("*[data-role='" + t + "view']").each(function (n, t) { var _n = $(t), s = new kendo.data.ObservableObject({}), e, o, f, h, c; if ($.trim(_n.attr("data-view-args")).length) { if (e = [], o = {}, i) with (i) try { eval("__args = " + _n.attr("data-view-args")) } catch (l) { console.error("Argument Parsing Error", "Could not parse inline page arguments: " + _n.attr("data-view-args")) } for (f in o) if (h = $.type(o[f]), h == "string" || h == "number" || h == "object") s.set(f, o[f]); else for (c in i) if (o[f] === i[c]) { e.push({ f: f, t: c }); s.set(f, i.get(c)); break } e.length && i.bind("change", function (n) { for (var t = 0; t < e.length; t++) if (e[t].t == n.field) { s.set(e[t].t, this.get(n.field)); break } }) } u.push(r.render(_n, _n.attr("data-view"), s)) }), $.when.apply($, u) }, createRenderer: function (n, t, i) { var s = $.type(n), n; if (s == "function") { if (n = new n(t, i), n instanceof r) return n } else if ($.type(n) == "string") switch (n.toLowerCase()) { case "kendomobile": return new f(t, i); case "react": return new e(t, i); case "knockout": return new o(t, i) } return new u(t, i) }, createResolver: function (n, t) { var i = $.type(n), n; if (i == "function") { if (n = new n(t), n instanceof _resolver) return n } else if ($.type(n) == "string") switch (n.toLowerCase()) { case "browserify": return new _renderer_Browserify(t) } return new _resolver_RequireJS(t) } })), r = kendo.Class.extend({ options: {}, resolver: null, init: function (n, t) { this.options = n; this.resolver = t }, render: function () { } }), u = r.extend({ render: function (i, r, u) { var h, e, l, v; if ($.type(r) == "string" && !($.trim(r).length <= 0) && $.type(i) == "object") { var c = this, o = $.Deferred(), a = r.indexOf("?"), s = a > 0 ? r.substring(0, a) : r, y = n.isObservableObject(u) ? u : new kendo.data.ObservableObject($.isPlainObject(u) ? u : {}), f = i; return i instanceof $ || (f = $(i)), h = f.find("*[data-role='" + t + "view']"), f.data(t + "View") && h.push(f), e = null, h.length ? (l = $.Deferred(), e = $.Deferred(), v = $.map(h, function (n) { var t = $(n); return { depth: t.parents().length, node: t } }).sort(function (n, t) { return t.depth - n.depth }).reduce(function (n, i) { return n.then(function () { return i.node.data(t + "View").model.deinit(i.node) }) }, l), v.always(function () { f.data(t + "View").destroy(); f.empty() }).always(function () { return c.resolver.resolve(c.options.paths.view + "/" + s + ".html").fail(function (n) { e.rejectWith(null, [n]) }).then(function (n) { e.resolveWith(null, [n]) }) }), l.resolve()) : e = this.resolver.resolve(this.options.paths.view + "/" + s + ".html"), this.resolver.resolve(this.options.paths.viewmodel + "/" + s + ".js").then(function (n) { var t = kendo.observable($.extend(!0, { preinit: function () { }, init: function () { }, __________init: function (n) { return this.init(n.view.element, n.sender.params) }, deinit: function () { } }, n)); e.then(function (n) { return c._wireTogether(f, s, y, n, t, o) }).fail(function () { o.rejectWith(null, arguments) }) }).fail(function () { o.rejectWith(null, arguments) }), o } }, _wireTogether: function (i, r, u, f, e, o) { var h = this, s = new kendo.View("<div>" + f + "<\/div>", { model: e, init: function () { var i = this, f = this.element.parent(); f.attr("data-role", t + "view"); f.attr("data-view", r); $.when(this.model.init(this.element, u)).always(function () { n.findNestedViews(i.element, i.model, h).then(function () { o.resolve() }).fail(function () { o.rejectWith(null, arguments) }) }) }, wrap: !1 }); return i.data(t + "View", s), $.when(e.preinit(i, u)).then(function () { var n = i.parents("*[data-role='" + t + "view']:first").data(t + "View"); n && n instanceof kendo.Layout ? n.showIn(s, i) : s.render(i) }) } }), f = u.extend({ _firstGo: !0, _wireTogether: function (r, f, e, o, s, h) { var a = this, c, l; return this._firstGo == !1 ? (c = $(o), l = "a" + kendo.guid().replace(new RegExp("-", "g"), ""), i.GlobalMobileModels[l] = s, c.each(function () { var i = $(this), u = $.trim(i.attr("data-role") || "").toLowerCase(), n, r; u.length && (i.attr("data-model", t + ".GlobalMobileModels." + l), u == "view" && (n = (i.attr("data-bind") || "").replace(new RegExp("events([ ]{0,}):([ ]{0,}){", "i"), "events:{"), r = n.indexOf("events:{"), r > -1 ? i.attr("data-bind", n.substring(0, r + 8) + " init: __________init, " + n.substring(r + 8, n.length)) : i.attr("data-bind", $.merge(n.length ? n.split(",") : [], ["events: { init: __________init }"]).join(",")))) }), $.when(s.preinit(r, e)).then(function () { var t = c.insertAfter(r); return n.findNestedViews(t, s, a).then(function () { h.resolve() }).fail(function () { h.rejectWith(null, arguments) }) })) : (this._firstGo = !1, u.fn._wireTogether.apply(a, arguments)) } }), e = r.extend({ render: function (n, t) { var i = $.Deferred(); return this.resolver.resolve(this.options.paths.view + "/" + t + ".js").then(function (t) { React.unmountComponentAtNode(n[0]); React.render(t, n[0], function () { i.resolve() }) }).fail(function () { i.rejectWith(null, arguments) }), i } }), o = r.extend({ render: function (t, i) { var r = $.Deferred(); return $.when(this.resolver.resolve(this.options.paths.view + "/" + i + ".html"), this.resolver.resolve(this.options.paths.viewmodel + "/" + i + ".js")).then(function (i, r) { for (var u in r) n.isArray(r[u]) ? r[u] = ko.observableArray(r[u]) : $.isFunction(r[u]) || (r[u] = ko.observable(r[u])); ko.cleanNode(t[0]); t.html(i); ko.applyBindings(r, t[0]) }).fail(function () { r.rejectWith(null, arguments) }), r } }), i; _resolver = kendo.Class.extend({ options: null, init: function (n) { this.options = n }, resolve: function () { throw "resolver didnt provide a resolve method."; } }); _resolver_JQuery = _resolver.extend({ resolve: function (n) { return n.match("js$") ? $.ajax({ url: n, dataType: "script" }).promise() : $.ajax({ url: n }).promise() } }); _resolver_RequireJS = _resolver.extend({ resolve: function (n) { var t = null; return n.match("js$") ? (t = $.Deferred(), require([n.replace(new RegExp(".js$"), "")], function (n) { t.resolveWith(null, [n]) }, function () { t.rejectWith(null, arguments) })) : t = $.ajax({ url: require.toUrl(n) }).promise(), t } }); _resolver_Browserify = _resolver.extend({ resolve: function (n) { return n.match(".js$") ? $.Deferred().resolveWith(null, [require(n.replace(new RegExp(".js$"), ""))]) : $.ajax({ url: n }).promise() } }); i = kendo.Class.extend({ options: {}, events: ["init", "before-navigate", "after-navigate", "before-load", "after-load"], router: null, mobileApp: null, modules: [], _events: $({}), _renderer: null, _resolver: null, init: function (i, r, u) { var f = this, e; for (this.options = $.extend({ node: $("body"), initial: null, init: null, transition: null, root: "/", pushState: !1, hashBang: !1, modules: [], paths: { view: "view", viewmodel: "viewmodel" }, renderer: "kendo", resolver: "requirejs" }, r), i && (this.options.node = i), e = 0; e < this.options.modules.length; e++) this.registerModule(this.options.modules[e]); f._resolver = n.createResolver(f.options.resolver, f.options); f._renderer = n.createRenderer(f.options.renderer, f.options, f._resolver); n.handleModuleHook(this.modules, "beforeInit", [this]).then(function () { var e, i; if (u && kendo.mobile && kendo.mobile.Application) return e = $.Deferred(), $.type(f.options.initial) == "string" && $.trim(f.options.initial).length > 0 ? f.load(f.options.node, r.initial, {}, n.createRenderer("kendomobile", f.options)).then(function () { f.options.node.prepend($("*[data-role='" + t + "view']:first").data(t + "View").element.children()); f.mobileApp = new kendo.mobile.Application(f.options.node, $.extend($.extend({}, f.options), { initial: null, init: function () { setTimeout(function () { e.resolve() }, 10) } })) }) : f.mobileApp = new kendo.mobile.Application(f.options.node, $.extend($.extend({}, f.options), { init: function () { setTimeout(function () { e.resolve() }, 10) } })), $.when(e).then(function () { f.router = f.mobileApp.router; f.router.bind("change", function (n) { f.trigger("before-navigate", [n.url, f.options.node]); setTimeout(function () { f.trigger("after-navigate", [n.url, f.options.node]) }, 10) }) }); f.router = new kendo.Router({ pushState: f.options.pushState, hashBang: f.options.hasBang, root: f.options.root }); f.router.route("*page", function (t, i) { n.handleModuleHook(f.modules, "beforeNavigate", [f.options.node, t, i]).then(function () { f.trigger("before-navigate", [t, f.options.node]); $.when(f._renderer.render(f.options.node, t, i)).fail(function (n) { f.router.trigger("routeMissing", n) }).then(function () { f.trigger("after-navigate", [t, f.options.node]) }) }).then(function () { return n.handleModuleHook(f.modules, "afterNavigate", [f.options.node, t, i]) }) }); i = location.href.indexOf("#"); $.trim(f.options.initial).length && (i < 0 || i == location.href.length - 1) && (location.href = i < 0 ? location.href + "#" + f.options.initial : location.href.substring(0, i) + "#" + f.options.initial) }).then(function () { return n.handleModuleHook(f.modules, "afterInit", [f]).then(function () { f.mobileApp || f.router.start(); $.isFunction(f.options.init) && f.options.init(f) }) }) }, registerModule: function (n) { n instanceof i.Module && $.grep(this.modules, function (t) { return n === t }).length == 0 ? this.modules.push(n) : console.error("Module is not an extension of " + t + ".Module") }, deregisterModule: function (n) { n instanceof i.Module && $.grep(this.modules, function (t) { return n === t }).length >= 1 ? this.modules = $.grep(function (t) { return n !== t }) : console.error("Module is not an extension of " + t + ".Module") }, navigate: function (n) { if (!this.router) { console.error("App not initialized: call initialize(DomNode contentNode, JSON options)"); return } if ($.type(n) == "string" && $.trim(n).length > 0) return this.mobileApp ? this.mobileApp.navigate.apply(this.mobileApp, arguments) : this.router.navigate.apply(this.router, arguments); console.error("Arguments Exception", "Page is empty; Usage: navigate(String page)") }, replace: function (n) { if (!this.router) { console.error("App not initialized: call initialize(DomNode contentNode, JSON options)"); return } if ($.type(n) == "string" && $.trim(n).length > 0) return this.mobileApp ? this.mobileApp.replace.apply(this.mobileApp, arguments) : this.router.replace.apply(this.router, arguments); console.error("Arguments Exception", "Page is empty; Usage: replace(String page)") }, load: function (t, i, f, e) { var o = this, s = this._renderer; if ((e instanceof r || e instanceof u) && (s = e), $.type(i) == "string" && $.trim(i).length > 0 && $.type(t) == "object") return n.handleModuleHook(this.modules, "beforeLoad", [t, i, f]).then(function () { return o.trigger("before-load", [t, i, f]), $.when(s.render.apply(s, [t, i, f])) }).then(function () { return n.handleModuleHook(o.modules, "afterLoad", [t, i, f]).then(function () { o.trigger("after-load", [t, i, f]) }) }); console.error("Arguments Exception", "Page is empty or node is not a DOM element; Usage: load(String page, DomNode node)") }, showLoading: function () { this.mobileApp ? this.mobileApp.showLoading() : kendo.ui.progress(this.options.node, !0) }, hideLoading: function () { kendo.ui.progress(this.options.node, !1); this.mobileApp && this.mobileApp.hideLoading() }, bind: function (n, t) { $.type(n) == "string" && $.trim(n).length > 0 && $.isFunction(t) ? this.mobileApp ? this.mobileApp.bind.apply(this.mobileApp, arguments) : this._events.bind.apply(this._events, arguments) : console.error("Arguments Exception", "Event is empty or method is not a function; Usage: bind(String event, Function method, ...)") }, trigger: function (n) { $.type(n) == "string" && $.trim(n).length > 0 ? this.mobileApp ? this.mobileApp.trigger.apply(this.mobileApp, arguments) : this._events.trigger.apply(this._events, arguments) : console.error("Arguments Exception", "Event is empty ; Usage: bind(String event, ...)") } }); kendo.isArray = n.isArray; kendo.isObservableObject = n.isObservableObject; kendo.mobile && (kendo.mobile.isArray = n.isArray, kendo.mobile.isObservableObject = n.isObservableObject); i.Renderer = r; i.Resolver = _resolver; i.Module = kendo.Class.extend({ beforeInit: function () { }, afterInit: function () { }, beforeNavigate: function () { }, afterNavigate: function () { }, beforeLoad: function () { }, afterLoad: function () { } }); i.GlobalMobileModels = {}; window[t] = i })();