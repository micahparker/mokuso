(function () { var n = "mokuso", t = new (kendo.Class.extend({ isArray: function (n) { return n && $.isArray(n) ? !0 : n && kendo.isFunction(n.shift) && kendo.isFunction(n.slice) ? !0 : !1 }, isObservableObject: function (n) { return n && $.type(n.uid) == "string" && kendo.isFunction(n.get) && kendo.isFunction(n.set) ? !0 : !1 }, handleModuleHook: function (n, t, i) { for (var u = [], r = 0; r < n.length; r++) $.isFunction(n[r][t]) && u.push(n[r][t].apply(n[r][t], i || [])); return $.when.apply(null, u) }, findNestedViews: function (t, i, r) { var u = []; return t.find("*[data-role='" + n + "view']").addBack("*[data-role='" + n + "view']").each(function (n, t) { var _n = $(t), l = _n.attr("data-view"), s = new kendo.data.ObservableObject({}), e, o, f, h, c; if ($.trim(_n.attr("data-view-args")).length) { if (e = [], o = {}, i) with (i) try { eval("__args = " + _n.attr("data-view-args")) } catch (a) { console.error("Argument Parsing Error", "Could not parse inline page arguments: " + _n.attr("data-view-args")) } for (f in o) if (h = $.type(o[f]), h == "string" || h == "number" || h == "object") s.set(f, o[f]); else for (c in i) if (o[f] === i[c]) { e.push({ f: f, t: c }); s.set(f, i.get(c)); break } e.length && i.bind("change", function (n) { for (var t = 0; t < e.length; t++) if (e[t].t == n.field) { s.set(e[t].t, this.get(n.field)); break } }) } u.push(r.render(_n, l, s)) }), $.when.apply($, u) }, createRenderer: function (n, t, i) { var s = $.type(n), n; if (s == "function") { if (n = new n(t, i), n instanceof r) return n } else if ($.type(n) == "string") switch (n.toLowerCase()) { case "kendomobile": return new f(t, i); case "react": return new e(t, i); case "knockout": return new o(t, i) } return new u(t, i) }, createResolver: function (n, t) { var i = $.type(n), n; if (i == "function") { if (n = new n(t), n instanceof _resolver) return n } else if ($.type(n) == "string") switch (n.toLowerCase()) { case "browserify": return new _renderer_Browserify(t) } return new _resolver_RequireJS(t) } })), r = kendo.Class.extend({ options: {}, resolver: null, init: function (n, t) { this.options = n; this.resolver = t }, render: function () { }, destroy: function () { } }), u = r.extend({ render: function (n, i, r) { var h; if ($.type(i) == "string" && !($.trim(i).length <= 0) && $.type(n) == "object") { var f = this, u = $.Deferred(), o = i.indexOf("?"), e = o > 0 ? i.substring(0, o) : i, c = t.isObservableObject(r) ? r : new kendo.data.ObservableObject($.isPlainObject(r) ? r : {}), s = n; return n instanceof $ || (s = $(n)), h = f.resolver.resolve(f.options.paths.view + "/" + e + ".html"), this.resolver.resolve(this.options.paths.viewmodel + "/" + e + ".js").then(function (n) { var t = kendo.observable($.extend(!0, { preinit: function () { }, init: function () { }, __________init: function (n) { return this.init(n.view.element, n.sender.params) }, deinit: function () { } }, n)); h.then(function (n) { return f._wireTogether(s, e, c, n, t, u) }).fail(function () { u.rejectWith(null, arguments) }) }).fail(function () { u.rejectWith(null, arguments) }), u } }, destroy: function (t) { var i = null, e = t.parents("*[data-role='" + n + "view']:first").data(n + "View"), r = t.find("*[data-role='" + n + "view']"), u, f; return t.data(n + "View") && r.push(t), r.length && (u = $.Deferred(), i = $.Deferred(), f = $.map(r, function (n) { var t = $(n); return { depth: t.parents().length, node: t } }).sort(function (n, t) { return t.depth - n.depth }).reduce(function (t, i) { return t.then(function () { return i.node.data(n + "View").model.deinit(i.node) }) }, u), f.then(function () { t.data(n + "View").destroy(); t.empty(); i.resolve() }).fail(function () { i.reject() }), u.resolve()), i == null && (i = $.Deferred().resolve()), i }, _initView: function (n, i) { var r = this; return $.when(n.model.init(n.element, i)).then(function () { return t.findNestedViews(n.element.children(), n.model, r) }) }, _wireTogether: function (t, i, r, u, f, e) { var o = this, s = new kendo.View("<div>" + u + "<\/div>", { model: f, init: function () { this.element.data(n + "View", this); this.element.attr("data-role", n + "view"); this.element.attr("data-view", i) }, show: function (t) { if (!o.options.transition || !t.sender.element.closest(o.options.node).length || !t.sender.element.siblings("[data-role=" + n + "view]").length) return o._initView(this, r).then(function () { e.resolve() }).fail(function () { e.rejectWith(null, arguments) }) }, transitionEnd: function (n) { if (n.type != "hide" || n.sender.___destroying) { if (o.options.transition) return o._initView(this, r).then(function () { e.resolve() }).fail(function () { e.rejectWith(null, arguments) }) } else return n.sender.___destroying = !0, o.destroy(n.sender.element) }, hide: function (n) { if (!n.sender.___destroying) return n.sender.___destroying = !0, o.destroy(n.sender.element) }, wrap: !1 }); return $.when(f.preinit(t, r)).then(function () { t.removeAttr("data-role"); t.removeAttr("data-view"); t.removeAttr("data-view-args"); var i = t.parents("*[data-role='" + n + "view']:first").data(n + "View"); i instanceof kendo.Layout ? i.showIn(t, s, o.options.transition) : s.render(t) }) } }), f = u.extend({ _firstGo: !0, _wireTogether: function (r, f, e, o, s, h) { var a = this, c, l; return this._firstGo == !1 ? (c = $(o), l = "a" + kendo.guid().replace(new RegExp("-", "g"), ""), i.GlobalMobileModels[l] = s, c.each(function () { var i = $(this), u = $.trim(i.attr("data-role") || "").toLowerCase(), t, r; u.length && (i.attr("data-model", n + ".GlobalMobileModels." + l), u == "view" && (t = (i.attr("data-bind") || "").replace(new RegExp("events([ ]{0,}):([ ]{0,}){", "i"), "events:{"), r = t.indexOf("events:{"), r > -1 ? i.attr("data-bind", t.substring(0, r + 8) + " init: __________init, " + t.substring(r + 8, t.length)) : i.attr("data-bind", $.merge(t.length ? t.split(",") : [], ["events: { init: __________init }"]).join(",")))) }), $.when(s.preinit(r, e)).then(function () { var n = c.insertAfter(r); return t.findNestedViews(n, s, a).then(function () { h.resolve() }).fail(function () { h.rejectWith(null, arguments) }) })) : (this._firstGo = !1, u.fn._wireTogether.apply(a, arguments)) } }), e = r.extend({ render: function (n, t) { var i = $.Deferred(); return this.resolver.resolve(this.options.paths.view + "/" + t + ".js").then(function (t) { React.unmountComponentAtNode(n[0]); React.render(t, n[0], function () { i.resolve() }) }).fail(function () { i.rejectWith(null, arguments) }), i } }), o = r.extend({ render: function (n, i) { var r = $.Deferred(); return $.when(this.resolver.resolve(this.options.paths.view + "/" + i + ".html"), this.resolver.resolve(this.options.paths.viewmodel + "/" + i + ".js")).then(function (i, r) { for (var u in r) t.isArray(r[u]) ? r[u] = ko.observableArray(r[u]) : $.isFunction(r[u]) || (r[u] = ko.observable(r[u])); ko.cleanNode(n[0]); n.html(i); ko.applyBindings(r, n[0]) }).fail(function () { r.rejectWith(null, arguments) }), r } }), i; _resolver = kendo.Class.extend({ options: null, init: function (n) { this.options = n }, resolve: function () { throw "resolver didnt provide a resolve method."; } }); _resolver_JQuery = _resolver.extend({ resolve: function (n) { return n.match("js$") ? $.ajax({ url: n, dataType: "script" }).promise() : $.ajax({ url: n }).promise() } }); _resolver_RequireJS = _resolver.extend({ resolve: function (n) { var t = null; return n.match("js$") ? (t = $.Deferred(), require([n.replace(new RegExp(".js$"), "")], function (n) { t.resolveWith(null, [n]) }, function () { t.rejectWith(null, arguments) })) : t = $.ajax({ url: require.toUrl(n) }).promise(), t } }); _resolver_Browserify = _resolver.extend({ resolve: function (n) { return n.match(".js$") ? $.Deferred().resolveWith(null, [require(n.replace(new RegExp(".js$"), ""))]) : $.ajax({ url: n }).promise() } }); i = kendo.Class.extend({ options: {}, events: ["init", "before-navigate", "after-navigate", "before-load", "after-load"], router: null, mobileApp: null, modules: [], _events: $({}), _renderer: null, _resolver: null, init: function (i, r, u) { var f = this, e; for (this.options = $.extend({ node: $("body"), initial: null, init: null, transition: "swap", root: "/", pushState: !1, hashBang: !1, modules: [], paths: { view: "view", viewmodel: "viewmodel" }, renderer: "kendo", resolver: "requirejs" }, r), i && (i instanceof $ || (i = $(i)), this.options.node = i), e = 0; e < this.options.modules.length; e++) this.registerModule(this.options.modules[e]); f._resolver = t.createResolver(f.options.resolver, f.options); f._renderer = t.createRenderer(f.options.renderer, f.options, f._resolver); t.handleModuleHook(this.modules, "beforeInit", [this]).then(function () { var o, s, h, e; if (u && kendo.mobile && kendo.mobile.Application) return o = $.Deferred(), $.type(f.options.initial) == "string" && $.trim(f.options.initial).length > 0 ? f.load(f.options.node, r.initial, {}, t.createRenderer("kendomobile", f.options, f._resolver)).then(function () { f.options.node.prepend($("*[data-role='" + n + "view']:first").data(n + "View").element.children()); f.mobileApp = new kendo.mobile.Application(f.options.node, $.extend($.extend({}, f.options), { initial: null, init: function () { setTimeout(function () { o.resolve() }, 10) } })) }) : f.mobileApp = new kendo.mobile.Application(f.options.node, $.extend($.extend({}, f.options), { init: function () { setTimeout(function () { o.resolve() }, 10) } })), $.when(o).then(function () { f.router = f.mobileApp.router; f.router.bind("change", function (n) { f.trigger("before-navigate", [n.url, f.options.node]); setTimeout(function () { f.trigger("after-navigate", [n.url, f.options.node]) }, 10) }) }); f.router = new kendo.Router({ pushState: f.options.pushState, hashBang: f.options.hasBang, root: f.options.root }); f.router.route("*page", function (n, i) { t.handleModuleHook(f.modules, "beforeNavigate", [f.options.node, n, i]).then(function () { f.trigger("before-navigate", [n, f.options.node]); $.when(f._renderer.render(f.options.node, n, i)).fail(function (n) { f.router.trigger("routeMissing", n) }).then(function () { f.trigger("after-navigate", [n, f.options.node]) }) }).then(function () { return t.handleModuleHook(f.modules, "afterNavigate", [f.options.node, n, i]) }) }); s = new kendo.Layout("<div><\/div>", { wrap: !0 }); s.render(i); f.options.node = i.children().children(); h = i.children(); h.attr("data-role", n + "view"); h.data(n + "View", s); e = location.href.indexOf("#"); $.trim(f.options.initial).length && (e < 0 || e == location.href.length - 1) && (location.href = e < 0 ? location.href + "#" + f.options.initial : location.href.substring(0, e) + "#" + f.options.initial) }).then(function () { return t.handleModuleHook(f.modules, "afterInit", [f]).then(function () { f.mobileApp || f.router.start(); $.isFunction(f.options.init) && f.options.init(f) }) }) }, registerModule: function (t) { t instanceof i.Module && $.grep(this.modules, function (n) { return t === n }).length == 0 ? this.modules.push(t) : console.error("Module is not an extension of " + n + ".Module") }, deregisterModule: function (t) { t instanceof i.Module && $.grep(this.modules, function (n) { return t === n }).length >= 1 ? this.modules = $.grep(function (n) { return t !== n }) : console.error("Module is not an extension of " + n + ".Module") }, navigate: function (n) { if (!this.router) { console.error("App not initialized: call initialize(DomNode contentNode, JSON options)"); return } if ($.type(n) == "string" && $.trim(n).length > 0) return this.mobileApp ? this.mobileApp.navigate.apply(this.mobileApp, arguments) : this.router.navigate.apply(this.router, arguments); console.error("Arguments Exception", "Page is empty; Usage: navigate(String page)") }, replace: function (n) { if (!this.router) { console.error("App not initialized: call initialize(DomNode contentNode, JSON options)"); return } if ($.type(n) == "string" && $.trim(n).length > 0) return this.mobileApp ? this.mobileApp.replace.apply(this.mobileApp, arguments) : this.router.replace.apply(this.router, arguments); console.error("Arguments Exception", "Page is empty; Usage: replace(String page)") }, load: function (n, i, f, e) { var o = this, s = this._renderer; if ((e instanceof r || e instanceof u) && (s = e), $.type(i) == "string" && $.trim(i).length > 0 && $.type(n) == "object") return t.handleModuleHook(this.modules, "beforeLoad", [n, i, f]).then(function () { return o.trigger("before-load", [n, i, f]), $.when(s.render.apply(s, [n, i, f])) }).then(function () { return t.handleModuleHook(o.modules, "afterLoad", [n, i, f]).then(function () { o.trigger("after-load", [n, i, f]) }) }); console.error("Arguments Exception", "Page is empty or node is not a DOM element; Usage: load(String page, DomNode node)") }, showLoading: function () { this.mobileApp ? this.mobileApp.showLoading() : kendo.ui.progress(this.options.node, !0) }, hideLoading: function () { kendo.ui.progress(this.options.node, !1); this.mobileApp && this.mobileApp.hideLoading() }, bind: function (n, t) { $.type(n) == "string" && $.trim(n).length > 0 && $.isFunction(t) ? this.mobileApp ? this.mobileApp.bind.apply(this.mobileApp, arguments) : this._events.bind.apply(this._events, arguments) : console.error("Arguments Exception", "Event is empty or method is not a function; Usage: bind(String event, Function method, ...)") }, trigger: function (n) { $.type(n) == "string" && $.trim(n).length > 0 ? this.mobileApp ? this.mobileApp.trigger.apply(this.mobileApp, arguments) : this._events.trigger.apply(this._events, arguments) : console.error("Arguments Exception", "Event is empty ; Usage: bind(String event, ...)") } }); kendo.isArray = t.isArray; kendo.isObservableObject = t.isObservableObject; kendo.mobile && (kendo.mobile.isArray = t.isArray, kendo.mobile.isObservableObject = t.isObservableObject); i.Renderer = r; i.Resolver = _resolver; i.Module = kendo.Class.extend({ beforeInit: function () { }, afterInit: function () { }, beforeNavigate: function () { }, afterNavigate: function () { }, beforeLoad: function () { }, afterLoad: function () { } }); i.GlobalMobileModels = {}; window[n] = i })();